{
  "dfe": [
    {
      "name": "root",
      "type": "div-flex",
      "_get": "[$$]",
      "attributes": "{class : 'div-flex', rowclass : 'div-flex-row', rowstyle: 'border: 1px solid; border-color: darkgray; border-radius: 5px; width: min-content;', rowclass$header : 'div-flex-row', rowclass$header2 : 'div-flex-row', rowclass$footer : 'div-flex-row', rowstyle$footer : 'flex-wrap: wrap; width: 800px;'}"
    },
    {
      "name": "l1",
      "parent": "root",
      "type": "label",
      "class": "header",
      "_get": "'Show only children of: '",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "childrenOf",
      "parent": "root",
      "type": "dropdown",
      "class": "header",
      "_get": "{ value: $$('childrenOf'), items: [{ value : [], description : 'All'}].concat($$('dfe').filter(px => px.get('.children') != 0).map(px => px.get('.name')).sort().map(s => o = { value : s})) }",
      "_set": "$$.set('hierarchyOf', []); $$.set('childrenOf', $$.value)",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "subChildren",
      "parent": "root",
      "type": "checkbox",
      "class": "header",
      "_get": "{ checked: $$('subChildren'), text: ''}",
      "_set": "$$.set('subChildren', $$.value)",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "l2",
      "parent": "root",
      "type": "label",
      "class": "header",
      "_get": "'Show hierarchy: '",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "hierarchyOf",
      "parent": "root",
      "type": "dropdown",
      "class": "header",
      "_get": "{ value: $$('hierarchyOf'), items: [{ value : [], description : 'All'}].concat($$('dfe').map(px => px.get('.name')).sort().map(s => o = { value : s})) }",
      "_set": "$$.set('childrenOf', []); $$.set('hierarchyOf', $$.value)",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "add_dfe",
      "parent": "root",
      "type": "button",
      "class": "footer",
      "_get": "'Add dfe field'",
      "_set": "var root = $$('dfe')[0].data; $$.form.changeParent(root.form.registerFields([{name: $$.form.generateName($$), type: 'editbox', _get: '[$$]'}])[0], $$('childrenOf') == 0 ? root.name : $$('childrenOf'))",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "height: min-content;"
      }
    },
    {
      "name": "append_css",
      "parent": "root",
      "type": "button",
      "_get": "'Append/update CSS'",
      "class": "footer",
      "_set": "$$.form.pushCSStoPage($$('css'), 'custom-css-dfe')",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "height: min-content;"
      }
    },
    {
      "name": "Pretty-print",
      "parent": "root",
      "type": "button",
      "_get": "'Pretty-print'",
      "class": "footer",
      "_set": "$$.runtime.notifyControls($$.runtime.findControls('pp_output'), 'pp')",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "height: min-content;"
      }
    },
    {
      "name": "Raw",
      "parent": "root",
      "type": "button",
      "_get": "'Raw'",
      "class": "footer",
      "_set": "$$.runtime.notifyControls($$.runtime.findControls('pp_output'), 'p')",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "height: min-content;"
      }
    },
    {
      "name": "load",
      "parent": "root",
      "type": "button",
      "_get": "'Load JSON'",
      "class": "footer",
      "_set": "$$.form.setTargetDfe($$, JSON.parse($$.runtime.findControls('pp_output')[0].ui.value))",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "height: min-content;"
      }
    },
    {
      "name": "ARF",
      "parent": "root",
      "type": "button",
      "_get": "'ARF'",
      "class": "footer",
      "_set": "$$.runtime.notifyControls($$.runtime.findControls('pp_output'), 'pa')",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "height: min-content;"
      }
    },      
    {
      "name": "validate",
      "parent": "root",
      "type": "button",
      "_get": "'Simulate validation'",
      "class": "footer",
      "_set": "$$.form.validateTarget($$)",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "height: min-content;"
      }
    },
    {
      "name": "restart",
      "parent": "root",
      "type": "button",
      "_get": "'Restart target'",
      "class": "footer",
      "_set": "$$.form.restartTarget($$)",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "height: min-content;"
      }
    },
      {
      "name": "editors",
      "parent": "root",
      "type": "div",
      "_get": "[$$]",
      "class": "footer",
      "attributes": "{ style : 'display: flex; flex-flow: row' }",
      "dpos": { "colclass": "div-flex-col" }
    },
    {
      "name": "css_text",
      "parent": "editors",
      "type": "textarea",
      "_get": "$$('css')",
      "class": "footer",
      "_set": "$$.set('css', value)",
      "attributes": "{ class: 'focus-front', trigger : 'change', style: 'width: 200px; z-index: 10;' }",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "pp_output",
      "parent": "editors",
      "type": "textarea",
      "_get": "($$.events[0]||{}).action=='pp' ? JSON.stringify($$.form.forPrinting($$.withListener(0)), null, 2) : JSON.stringify($$.form.forPrinting($$.withListener(0)))",
      "class": "footer",
      "attributes": "{ class: 'focus-front', trigger : 'change' }",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle": "position: absolute; left: 300px;"
      }
    },
    {
      "name": "dfe_row",
      "parent": "root",
      "type": "div-flex",
      "_get": "$$.form.getFieldList($$, $$('childrenOf'), $$('hierarchyOf'), $$('subChildren'))",
      "attributes": "{ class : 'div-flex-h', style: 'box-sizing: border-box; overflow-y: scroll; height: 400px;', rowclass$header : 'div-alt-color-fc', orientation: 'horizontal', events: { mouseover: $$.form.highlightField, mouseleave: $$.form.highlightField } }",
      "dpos": {
        "colclass": "div-flex-col",
        "colstyle" : "margin: 0px;padding: 0px;"
      }
    },
    {
      "name": "up_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'x'",
      "attributes": "{style : 'visibility:hidden'}",
      "dpos": {
        "colclass": "div-flex-col -sticky-header",
        "colstyle": "border-top-left-radius: 3px;"
      }
    },
    {
      "name": "name_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Field name'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header"
      }
    },
    {
      "name": "parent_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Parent'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header"
      }
    },
    {
      "name": "type_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Type'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header"
      }
    },
    {
      "name": "get_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Getter'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header"
      }
    },
    {
      "name": "set_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Setter'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header"
      }
    },
    {
      "name": "val_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Validation'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header"
      }
    },
    {
      "name": "attr_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Attributes'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header"
      }
    },
    {
      "name": "del_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Del.'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header",
        "colstyle": "margin-bottom: 0px;"
      }
    },
    {
      "name": "class_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Class'",
      "dpos": {
        "colclass": "div-flex-col -sticky-header",
        "colstyle": "margin-bottom: 0px;"
      }
    },
    {
      "name": "ppos_field_h",
      "parent": "dfe_row",
      "type": "label",
      "class": "header",
      "_get": "'Layout specific'",
      "attributes": "{ style : 'white-space: nowrap;' }",
      "dpos": {
        "colclass": "div-flex-col -sticky-header",
        "colstyle": "border-top-right-radius: 3px;margin-bottom: 0px;"
      }
    },
    {
      "name": "field_up",
      "parent": "dfe_row",
      "type": "dropdown",
      "_get": "{ value: $$.index(), items: $$.get('..dfe').map(function(o, n) { return {value: n}}).slice(1) }",
      "_set": "$$.form.moveField($$, value)",
      "attributes": "{ style : ($$.index() ? '' : 'visibility:hidden;') + 'width: 32px; padding: 0px; -webkit-appearance: none; height: 19px; text-indent: 1px;direction: rtl;' }",
      "dpos": {
        "colclass": "div-flex-col editbox-col --hover-visible"
      }
    },
    {
      "name": "name_field",
      "parent": "dfe_row",
      "type": "editbox",
      "_get": "$$('.name')",
      "_set": "$$.form.changeName($$, value)",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "parent_field",
      "parent": "dfe_row",
      "type": "dropdown",
      "_get": "{ value : $$('.parent'), items :  $$('dfe').filter(px => px.get('.component').isContainer()).map(px => px.get('.name')).sort().map(s => o = {value : s})}",
      "_set": "$$.form.changeParent($$, value)",
      "attributes": "{ style : $$('.parent') == 0 ? 'visibility:hidden;' : ''}",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "type_field",
      "parent": "dfe_row",
      "type": "dropdown",
      "_get": "{ value : $$('.type'), items : Array.from($$.form.components.keys()).sort().map(s => o = { value : s})}",
      "_set": "$$.form.changeType($$, value)",
      "dpos": {
        "colclass": "div-flex-col editbox-col"
      }
    },
    {
      "name": "get_field",
      "parent": "dfe_row",
      "type": "editbox-P",
      "_get": "$$('._get')",
      "_set": "$$.set('._get', value); $$.form.fixFunctions($$, true)",
      "attributes": "{ style : 'margin: 0px', spellcheck: 'false', vstrategy : 'always', eclass : 'editbox-error', ta: { cols: 50, rows : 5, class : 'popup-edit-popup', spellcheck: 'false', eclass : 'editbox-error'}}",
      "validation": "if($$('._get') != 0 && $$('.get') == 0) $$.error = 'Compilation error'",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "set_field",
      "parent": "dfe_row",
      "type": "editbox-P",
      "_get": "$$('._set')",
      "_set": "$$.set('._set', value); $$.form.fixFunctions($$, true)",
      "attributes": "{ style : 'margin: 0px', spellcheck: 'false', vstrategy : 'always', eclass : 'editbox-error', ta: { cols: 50, rows : 5, class : 'popup-edit-popup', spellcheck: 'false', eclass : 'editbox-error'}}",
      "validation": "if($$('._set') != 0 && $$('.set') == 0) $$.error = 'Compilation error'",
      "dpos": {
        "colclass": "div-flex-col"
      }
    }, 
    {
      "name": "val_field",
      "parent": "dfe_row",
      "type": "editbox-P",
      "_get": "$$('.validation')",
      "_set": "$$.set('.validation', value); $$.form.fixFunctions($$, true)",
      "attributes": "{ style : 'margin: 0px', spellcheck: 'false', vstrategy : 'always', eclass : 'editbox-error', ta: { cols: 50, rows : 5, class : 'popup-edit-popup', spellcheck: 'false', eclass : 'editbox-error'}}",
      "validation": "if($$('.validation') != 0 && $$('.val') == 0) $$.error = 'Compilation error'",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "attr_field",
      "parent": "dfe_row",
      "type": "editbox-P",
      "_get": "$$('.attributes')",
      "_set": "$$.set('.attributes', value); $$.form.fixFunctions($$, true)",
      "attributes": "{ style : 'margin: 0px', spellcheck: 'false', vstrategy : 'always', eclass : 'editbox-error', ta: { cols: 50, rows : 5, class : 'popup-edit-popup', spellcheck: 'false', eclass : 'editbox-error'}}",
      "validation": "if($$('.attributes') != 0 && $$('.atr') == 0) $$.error = 'Compilation error'",
      "dpos": {
        "colclass": "div-flex-col"
      }
    },
    {
      "name": "field_del",
      "parent": "dfe_row",
      "type": "button",
      "_get": "'X'",
      "_set": "$$.form.delete($$)",
      "attributes": "{ style : $$('.parent') == 0 ? 'visibility:hidden;' : ''}",
      "dpos": {
        "colclass": "div-flex-col editbox-col"
      }
    },
    {
      "name": "class_field",
      "parent": "dfe_row",
      "type": "dropdown",
      "_get": "{ value : $$('.class'), items: [ {value : [], description : ''}, {value: 'header'} ] }",
      "_set": "$$.set('.class', value); $$.form.changeTPos($$)",
      "attributes": "{ style : $$('.parent') == 0 ? 'visibility:hidden;' : ''}",
      "dpos": {
        "colclass": "div-flex-col editbox-col"
      }
    },
    {
      "name": "layout_spec_ctrl",
      "parent": "dfe_row",
      "type": "div",
      "_get": "[$$]",
      "attributes": "{ style : 'padding:0px 1px 0px 1px; display: flex; flex-direction: row;'}"
    },
    {
      "name": "tpos_ctrl",
      "parent": "layout_spec_ctrl",
      "type": "div-flex",
      "_get": "$$('.parent') == 0 || getContainerLayout($$) != 'tpos' ? [] : [$$]",
      "class": "header",
      "attributes": "{ class : 'div-flex', rowclass : 'div-flex-row'}",
      "dpos": {
        "colclass": "div-flex-col-embedded-1"
      }
    },
    {
      "name": "pos_field_left",
      "parent": "tpos_ctrl",
      "type": "button",
      "_get": "'left'",
      "attributes": "{ disabled : $$('.tpos').x == 0}",
      "_set": "$$.form.pushLeft($$)",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "pos_field_right",
      "parent": "tpos_ctrl",
      "type": "button",
      "_get": "'right'",
      "_set": "$$.form.changeTPos($$, $$('.tpos').x + 1)",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "pos_field_up",
      "parent": "tpos_ctrl",
      "type": "button",
      "_get": "'oopa'",
      "attributes": "{ disabled : $$('.tpos').y == 0}",
      "_set": "$$.form.pushUp($$)",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "pos_field_down",
      "parent": "tpos_ctrl",
      "type": "button",
      "_get": "'down'",
      "_set": "$$.form.changeTPos($$, undefined, $$('.tpos').y + 1)",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "pos_field_cs",
      "parent": "tpos_ctrl",
      "type": "dropdown",
      "_get": "{ value : $$('.tpos').c, items: [ {value : ''}, {value: 2}, {value : 3}, {value : 4}, {value : 5}, {value : 6}, {value : 7}, {value : 8}, {value : 9}, {value : 10}]}",
      "_set": "$$.form.changeTPos($$, undefined, undefined, value == '' ? [] : value)",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "pos_field_rs",
      "parent": "tpos_ctrl",
      "type": "dropdown",
      "_get": "{ value : $$('.tpos').r, items: [ {value : ''}, {value: 2}, {value : 3}, {value : 4}, {value : 5}, {value : 6}, {value : 7}, {value : 8}, {value : 9}, {value : 10}]}",
      "_set": "$$.form.changeTPos($$, undefined, undefined, undefined, value == '' ? [] : value)",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "dpos_ctrl",
      "parent": "layout_spec_ctrl",
      "type": "div-flex",
      "_get": "$$('.parent')==0 || getContainerLayout($$) == 'dpos' ? [$$] : []",
      "class": "header",
      "attributes": "{ style: $$('.parent')==0 ? 'visibility: hidden':'', class : 'div-flex', rowclass : 'div-flex-row'}",
      "dpos": {
        "colclass": "div-flex-col-embedded-1"
      }
    },
    {
      "name": "dpos_colclass_l",
      "parent": "dpos_ctrl",
      "type": "label",
      "_get": "'class: '",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "dpos_colclass",
      "parent": "dpos_ctrl",
      "type": "editbox",
      "_get": "$$('.dpos').colclass == undefined ? '' : $$('.dpos').colclass",
      "_set": "var v = _extend($$('.dpos'), {}); if(value) v.colclass=value; else delete v.colclass; $$.set('.dpos', v)",
      "attributes": "{ style : 'width: 100px'}",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "dpos_colstyle_l",
      "parent": "dpos_ctrl",
      "type": "label",
      "_get": "'style: '",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    },
    {
      "name": "dpos_colstyl",
      "parent": "dpos_ctrl",
      "type": "editbox",
      "_get": "$$('.dpos').colstyle == undefined ? '' : $$('.dpos').colstyle",
      "_set": "var v = _extend($$('.dpos'), {}); if(value) v.colstyle=value; else delete v.colstyle; $$.set('.dpos', v)",
      "attributes": "{ style : 'width: 100px'}",
      "dpos": {
        "colclass": "div-flex-col-embedded"
      }
    }
  ]
}