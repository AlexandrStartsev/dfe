{
  "dfe": [
    {
      "name": "root",
      "type": "container",
      "_get": "[$$]",
      "tpos": {
        "x": 0,
        "y": 0
      }
    },
    {
      "name": "header",
      "parent": "root",
      "type": "container",
      "_get": "[$$]",
      "tpos": {
        "x": 0,
        "y": 0
      }
    },
    {
      "name": "l1",
      "parent": "header",
      "type": "label",
      "_get": "'Show only children of: '",
      "tpos": {
        "x": 0,
        "y": 0
      }
    },
    {
      "name": "childrenOf",
      "parent": "header",
      "type": "dropdown",
      "_get": "{ value: $$('childrenOf'), items: [{ value : [], description : 'All'}].concat($$('dfe').filter(px => px.get('.children') != 0).map(px => px.get('.name')).sort().map(s => o = { value : s})) }",
      "_set": "$$.set('hierarchyOf', []); $$.set('childrenOf', $$.value)",
      "tpos": {
        "x": 1,
        "y": 0
      }
    },
    {
      "name": "l2",
      "parent": "header",
      "type": "label",
      "_get": "'Show hierarchy: '",
      "tpos": {
        "x": 2,
        "y": 0
      }
    },
    {
      "name": "hierarchyOf",
      "parent": "header",
      "type": "dropdown",
      "_get": "{ value: $$('hierarchyOf'), items: [{ value : [], description : 'All'}].concat($$('dfe').map(px => px.get('.name')).sort().map(s => o = { value : s})) }",
      "_set": "$$.set('childrenOf', []); $$.set('hierarchyOf', $$.value)",
      "tpos": {
        "x": 3,
        "y": 0
      }
    },
    {
      "name": "footer",
      "parent": "root",
      "type": "container",
      "_get": "[$$]",
      "tpos": {
        "x": 0,
        "y": 2
      }
    },
    {
      "name": "add_dfe",
      "parent": "footer",
      "type": "button",
      "_get": "'Add dfe field'",
      "_set": "var root = $$('dfe')[0].data; $$.manager.changeParent(root.manager.registerFields([{name: '{Change Name}', type: 'editbox', _get: '[$$]', tpos: {x : 0, y : 0}}])[0], $$('childrenOf') == 0 ? root.name : $$('childrenOf'))",
      "tpos": {
        "x": 0,
        "y": 0
      }
    },
    {
      "name": "pp",
      "parent": "footer",
      "type": "button",
      "_get": "'Prettyprint to console'",
      "_set": "console.log(JSON.stringify($$.manager.forPrinting($$('')[0]), null, 2))",
      "tpos": {
        "x": 1,
        "y": 0
      }
    },
    {
      "name": "root_c",
      "parent": "root",
      "type": "container",
      "_get": "$$.manager.getFieldList($$, $$('childrenOf'), $$('hierarchyOf'))",
      "tpos": {
        "x": 0,
        "y": 1
      }
    },
    {
      "name": "name_field",
      "parent": "root_c",
      "type": "editbox",
      "attributes": "{classList : 'editor-editbox'}",
      "_get": "$$('.name')",
      "_set": "$$.manager.changeName($$, value)",
      "tpos": {
        "x": 0,
        "y": 0
      }
    },
    {
      "name": "parent_field",
      "parent": "root_c",
      "type": "dropdown",
      "_get": "{ value : $$('.parent'), items :  $$('dfe').filter(px => px.get('.component').isContainer()).map(px => px.get('.name')).sort().map(s => o = {value : s})}",
      "_set": "$$.manager.changeParent($$, value)",
      "attributes": "{ hidden : $$('.parent') == 0 }",
      "tpos": {
        "x": 1,
        "y": 0
      }
    },
    {
      "name": "type_field",
      "parent": "root_c",
      "type": "dropdown",
      "_get": "{ value : $$('.type'), items : Array.from($$.manager.components.keys()).map(s => o = { value : s})}",
      "_set": "$$.manager.changeType($$, value)",
      "tpos": {
        "x": 2,
        "y": 0
      }
    },
    {
      "name": "get_field",
      "parent": "root_c",
      "type": "div",
      "attributes": "{ hmodel : $$, class : 'popup-edit-div-container'}",
      "tpos": {
        "x": 3,
        "y": 0
      }
    },
    {
      "name": "get_field_ed1",
      "parent": "get_field",
      "type": "editbox",
      "class": "header",
      "_get": "$$('._get')",
      "_set": "$$.set('._get', value); $$.manager.fixFunctions($$, true)",
      "attributes": "{ style : 'margin: 1px'}",
      "validation": "if($$('._get') != 0 && $$('.get') == 0) $$.error = 'Compilation error'"
    },
    {
      "name": "get_field_ed2",
      "parent": "get_field",
      "type": "textarea",
      "class": "header",
      "attributes": "{ cols: 50, rows : 5, style : 'margin: 1px; z-index:100'}",
      "_get": "$$('._get')",
      "_set": "$$.set('._get', value); $$.manager.fixFunctions($$, true)",
      "validation": "if($$('._get') != 0 && $$('.get') == 0) $$.error = 'Compilation error'"
    },
    {
      "name": "set_field",
      "parent": "root_c",
      "type": "div",
      "attributes": "{ hmodel : $$, class : 'popup-edit-div-container'}",
      "tpos": {
        "x": 4,
        "y": 0
      }
    },
    {
      "name": "set_field_ed1",
      "parent": "set_field",
      "type": "editbox",
      "class": "header",
      "_get": "$$('._set')",
      "_set": "$$.set('._set', value); $$.manager.fixFunctions($$)",
      "validation": "if($$('._set') != 0 && $$('.set') == 0) $$.error = 'Compilation error'",
      "attributes": "{ style : 'margin: 1px'}"
    },
    {
      "name": "set_field_ed2",
      "parent": "set_field",
      "type": "textarea",
      "class": "header",
      "attributes": "{ cols: 50, rows : 5, style : 'margin: 1px; z-index:100'}",
      "_get": "$$('._set')",
      "_set": "$$.set('._set', value); $$.manager.fixFunctions($$)",
      "validation": "if($$('._set') != 0 && $$('.set') == 0) $$.error = 'Compilation error'"
    },
    {
      "name": "val_field",
      "parent": "root_c",
      "type": "div",
      "attributes": "{ hmodel : $$, class : 'popup-edit-div-container'}",
      "tpos": {
        "x": 5,
        "y": 0
      }
    },
    {
      "name": "val_field_ed1",
      "parent": "val_field",
      "type": "editbox",
      "class": "header",
      "_get": "$$('.validation')",
      "_set": "$$.set('.validation', value); $$.manager.fixFunctions($$)",
      "validation": "if($$('.validation') != 0 && $$('.val') == 0) $$.error = 'Compilation error'",
      "attributes": "{ style : 'margin: 1px'}"
    },
    {
      "name": "val_field_ed2",
      "parent": "val_field",
      "type": "textarea",
      "class": "header",
      "attributes": "{ cols: 50, rows : 5, style : 'margin: 1px; z-index:100'}",
      "_get": "$$('.validation')",
      "_set": "$$.set('.validation', value); $$.manager.fixFunctions($$)",
      "validation": "if($$('.validation') != 0 && $$('.val') == 0) $$.error = 'Compilation error'"
    },
    {
      "name": "attr_field",
      "parent": "root_c",
      "type": "div",
      "attributes": "{ hmodel : $$, class : 'popup-edit-div-container'}",
      "tpos": {
        "x": 6,
        "y": 0
      }
    },
    {
      "name": "attr_field_ed1",
      "parent": "attr_field",
      "type": "editbox",
      "class": "header",
      "_get": "$$('.attributes')",
      "_set": "$$.set('.attributes', value); $$.manager.fixFunctions($$)",
      "validation": "if($$('.attributes') != 0 && $$('.atr') == 0) $$.error = 'Compilation error'",
      "attributes": "{ style : 'margin: 1px'}"
    },
    {
      "name": "attr_field_ed2",
      "parent": "attr_field",
      "type": "textarea",
      "class": "header",
      "attributes": "{ cols: 50, rows : 5, style : 'margin: 1px; z-index:100'}",
      "_get": "$$('.attributes')",
      "_set": "$$.set('.attributes', value); $$.manager.fixFunctions($$)",
      "validation": "if($$('.attributes') != 0 && $$('.atr') == 0) $$.error = 'Compilation error'"
    },
    {
      "name": "field_del",
      "parent": "root_c",
      "type": "button",
      "_get": "'X'",
      "_set": "$$.manager.delete($$)",
      "attributes": "{ hidden: $$('.parent') ==0 }",
      "tpos": {
        "x": 7,
        "y": 0
      }
    },
    {
      "name": "class_field",
      "parent": "root_c",
      "type": "dropdown",
      "_get": "{ value : $$('.class'), items: [ {value : [], description : ''}, {value: 'header'} ] }",
      "_set": "$$.set('.class', value); $$.manager.changeTPos($$)",
      "attributes": "{ hidden: $$('.parent') ==0 }",
      "tpos": {
        "x": 8,
        "y": 0
      }
    },
    {
      "name": "tpos_ctrl",
      "parent": "root_c",
      "type": "container",
      "_get": "[$$]",
      "_set": "[$$]",
      "attributes": "{ hidden: $$('.parent') ==0 || getContainerLayout($$) != 'tpos' }",
      "tpos": {
        "x": 9,
        "y": 0
      }
    },
    {
      "name": "pos_field_left",
      "parent": "tpos_ctrl",
      "type": "button",
      "_get": "'left'",
      "attributes": "{ disabled : $$('.tpos').x == 0}",
      "_set": "$$.manager.pushLeft($$)",
      "tpos": {
        "x": 0,
        "y": 0
      }
    },
    {
      "name": "pos_field_right",
      "parent": "tpos_ctrl",
      "type": "button",
      "_get": "'right'",
      "_set": "$$.manager.changeTPos($$, $$('.tpos').x + 1)",
      "tpos": {
        "x": 1,
        "y": 0
      }
    },
    {
      "name": "pos_field_up",
      "parent": "tpos_ctrl",
      "type": "button",
      "_get": "'oopa'",
      "attributes": "{ disabled : $$('.tpos').y == 0}",
      "_set": "$$.manager.pushUp($$)",
      "tpos": {
        "x": 2,
        "y": 0
      }
    },
    {
      "name": "pos_field_down",
      "parent": "tpos_ctrl",
      "type": "button",
      "_get": "'down'",
      "_set": "$$.manager.changeTPos($$, undefined, $$('.tpos').y + 1)",
      "tpos": {
        "x": 3,
        "y": 0
      }
    },
    {
      "name": "pos_field_cs",
      "parent": "tpos_ctrl",
      "type": "dropdown",
      "_get": "{ value : $$('.tpos').c, items: [ {value : ''}, {value: 2}, {value : 3}, {value : 4}, {value : 5}, {value : 6}, {value : 7}, {value : 8}, {value : 9}, {value : 10}]}",
      "_set": "$$.manager.changeTPos($$, undefined, undefined, value == '' ? [] : value)",
      "tpos": {
        "x": 5,
        "y": 0
      }
    },
    {
      "name": "pos_field_rs",
      "parent": "tpos_ctrl",
      "type": "dropdown",
      "_get": "{ value : $$('.tpos').r, items: [ {value : ''}, {value: 2}, {value : 3}, {value : 4}, {value : 5}, {value : 6}, {value : 7}, {value : 8}, {value : 9}, {value : 10}]}",
      "_set": "$$.manager.changeTPos($$, undefined, undefined, undefined, value == '' ? [] : value)",
      "tpos": {
        "x": 6,
        "y": 0
      }
    }
  ]
}